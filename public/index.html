<script>
  window.onload = function() {
    console.log("SET");
    getAndDisplayMeme();
  }

  function getAndDisplayMeme() {
      url = getRandomMemeURL();
      imgElement = document.getElementById("memeIMG");
      videoElement = document.getElementById("memeVIDEO");

      postfix = url.slice(Math.max(url.length - 4, 1));

      if(postfix == "webm") {
          imgElement.style.visibility = "hidden";
          videoElement.style.visibility = "visible";
          videoElement.src = url;
          timeOut = 15000;
          videoElement.addEventListener('loadedmetadata', function() { // EVent for end of video
            timeOut = videoElement.duration * 1000;
            setTimeout( function() {
                getAndDisplayMeme();
            }, timeOut);
          });
      } else {
          imgElement.style.visibility = "visible";
          videoElement.style.visibility = "hidden";
          videoElement.src = "";
          imgElement.src = url;
          if(postfix == ".gif")
            timeOut = 10000;
          else
            timeOut = 5000;
        setTimeout( function() {
            getAndDisplayMeme();
        }, timeOut);
      }


  }

  function getRandomMemeURL() {
     var xmlHttp = new XMLHttpRequest();
     xmlHttp.open( "GET", "randomMeme", false ); // false for synchronous request
     xmlHttp.send( null );
     return xmlHttp.responseText;
 }

 function getWebmLength(htmlElement) {
     console.log(htmlElement.duration);
     timeOut = htmlElement.duration * 1000;
 }

</script>

<style>
body {
    background-color: black;
}

.memeImg {
    position: fixed;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    max-width: 100%;
    max-height: 100%;
    min-width: 50%;
    min-height: 75%;
    margin: auto;
    overflow: auto;
}

.memeVid {
    position: fixed;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    max-width: 100%;
    max-height: 100%;
    min-width: 50%;
    min-height: 75%;
    margin: auto;
    overflow: auto;
}

</style>


<body>
hello world!
<br>
<img id="memeIMG" class="memeImg" src=""\>

<video autoplay="true" id="memeVIDEO" class="memeVid" loop="true">
  <source src="movie.mp4" type="video/mp4">
  <source src="movie.ogg" type="video/ogg">
Your browser does not support the video tag.
</video>
</body>
